<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="qunit/qunit.css">
    <script src="qunit/qunit.js"></script>  
</head>
<body>
    <!-- QUNIT -->
    <h1 id="qunit-header">QUnit Test Suite</h1>  
    <h2 id="qunit-banner"></h2>  
    <div id="qunit-testrunner-toolbar"></div>  
    <h2 id="qunit-userAgent"></h2>  
    <ol id="qunit-tests"></ol>  

    <!-- FIXTURES -->
    <div id="test-resizeImages">
        <div>
            <img x-src="http://test/1.jpg" />
            <img x-src="/2.jpg" />
        </div>
        <img x-src="/3.jpg" />
    </div>

    <div id="test-resizeImages-args-1">
        <img x-src="/1.jpg" />
    </div>

    <div id="test-resizeImages-args-2">
        <img x-src="/2.jpg" />
    </div>

    <!-- SETUP -->
    <script>Mobify = {config: {}}</script>
    <script src="../vendor/zepto/src/zepto.js"></script>
    <script src="../vendor/zepto/src/event.js"></script>
    <script src="../api/noconflict.js"></script>

    <script src="../api/resizeImages.js"></script>

    <!-- TESTS -->
    <script>
        $ = Mobify.$

        module('api/resizeImages.js')

        test('Mobify.URLHash', function(t) {
            var got = Mobify.URLHash('http://test/image.jpg')
              , vow = 3009026534

            equal(got, vow)
        });

        test('Mobify.getImageURL', function() {
            equal(Mobify.getImageURL('http://test/1.jpg'), '//ir3.mobify.com/http://test/1.jpg')
            equal(Mobify.getImageURL('http://test/1.jpg', {maxWidth: 320}), '//ir3.mobify.com/320/http://test/1.jpg')
        });

        test('$.fn.resizeImages', function() {
            var $resized = $('#test-resizeImages').resizeImages()
            equal($resized.length, 3)
        });

        test('$.fn.resizeImages with args', function() {
            var $resized = $('#test-resizeImages-args-1').resizeImages(320)
            equal($resized.filter('[x-src]').length, 1)

            $('#test-resizeImages-args-2').resizeImages({maxWidth: 320})
        });
    </script>
<body>
</html>