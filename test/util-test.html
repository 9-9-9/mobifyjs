<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="/test/qunit/qunit.css">
    <script src="/test/qunit/qunit.js"></script>  
    
</head>
<body>
    <!-- 
    Usage:
    # Run test-server for checkout folder.
    $ node test/test-server.js
    # Navigate to this page:
    $ http://127.0.0.1:8001/test/util-test.html
    -->
    <h1 id="qunit-header">QUnit Test Suite</h1>  
    <h2 id="qunit-banner"></h2>  
    <div id="qunit-testrunner-toolbar"></div>  
    <h2 id="qunit-userAgent"></h2>  
    <ol id="qunit-tests"></ol>  


    <div id="test-resizeImages">
        <div>
            <img x-src="http://test/1.jpg" />
            <img x-src="/2.jpg" />
        </div>
        <img x-src="/3.jpg" />
    </div>

    <div id="test-resizeImages-args-1">
        <img x-src="/1.jpg" />
    </div>

    <div id="test-resizeImages-args-2">
        <img x-src="/2.jpg" />
    </div>


    <div id="test-resizeImages-speed">
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
        <img x-src="/1.jpg" />
    </div>


    <script src="/lib/jquery-latest.js"></script>
    <script src="/lib/underscore.js"></script>
    <script>Mobify = {config: {}, $: $, _: _}; debug = console</script>
    <script src="/api/util.js"></script>
    <script>

test('Mobify.URLHash', function(t) {
    Mobify.URLHash('http://test/image.jpg')
});

test('Mobify.getImageURL', function() {
    equal(Mobify.getImageURL('http://test/1.jpg'), '//ir3.mobify.com/http://test/1.jpg')
    equal(Mobify.getImageURL('http://test/1.jpg', {maxWidth: 320}), '//ir3.mobify.com/320/http://test/1.jpg')
});

test("Mobify.ios8_0ScrollFix", function() {
    var html =
        "<html>" +
        "<head>" +
        "  <title>Scroll Fix Test</title>" +
        "</head>" +
        "<body style='font-size: 13px' class='x-test'>" +
        "  <ul>" +
        "    <li>Woohoo</li>" +
        "  </ul>" +
        "</body>" +
        "</html>";

    html = Mobify.ios8_0ScrollFix(html);
    
    ok(html.indexOf('font-size: 13px') !== -1,
        '`font-size: 13px` on the body tag is still present');
    ok(html.indexOf('display: none') !== -1,
        '`display: none` was set on the body tag');
    ok(html.indexOf("document.body.style.display = '';") !== -1,
        'there is a script to show the body');
    ok(html.indexOf('x-test') !== -1,
        '`x-test` body class tag is still present');
});

test('$.fn.resizeImages', function() {
    var $resized = Mobify.$('#test-resizeImages').resizeImages()
    equal($resized.length, 3)
});

test('$.fn.resizeImages with args', function() {
    var $resized = Mobify.$('#test-resizeImages-args-1').resizeImages(320)
    equal($resized.filter('[x-src]').length, 1)

    Mobify.$('#test-resizeImages-args-2').resizeImages({maxWidth: 320})
});

test('$.fn.resizeImages speed', function() {
    var start = +new Date
    Mobify.$('#test-resizeImages-speed').resizeImages()
    console.log(+new Date - start)
    
});



    </script>
<body>
</html>